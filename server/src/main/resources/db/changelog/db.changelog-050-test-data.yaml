databaseChangeLog:
  - changeSet:
      id: 050-seed-test-data
      author: wgmlgz
      context: dev,test
      changes:
        - sql:
            splitStatements: false
            sql: |
              INSERT INTO person (id, first_name, last_name, middle_name, date_of_birth, gender, phone_number, email, address) VALUES
              (1, 'John', 'Doe', 'Andrew', '1985-05-20', 'M', '+10000000001', 'john.doe@example.com', '123 Main Street'),
              (2, 'Jane', 'Smith', NULL, '1990-08-15', 'F', '+10000000002', 'jane.smith@example.com', '456 Oak Avenue'),
              (3, 'Sam', 'Service', NULL, '1982-11-25', 'M', '+10000000003', 'service.user@example.com', '789 Pine Road'),
              (4, 'Peter', 'Patient', NULL, '1995-03-10', 'M', '+10000000004', 'peter.patient@example.com', '12 Clinic Way'),
              (5, 'Paula', 'Patient', NULL, '1988-02-17', 'F', '+10000000005', 'paula.patient@example.com', '34 Health Blvd');

              INSERT INTO role (id, role_name, description) VALUES
              (1, 'ADMIN', 'Administrator'),
              (2, 'MEDIC', 'Medical staff'),
              (3, 'SERVICE', 'Service account');

              INSERT INTO user_profile (id, person_id, username, password_hash, date_registered) VALUES
              (1, 1, 'admin', '$2a$10$7DO2tMe6QSZw7/qpTug3uuoSX7FYhnPMvJ6sSENxvtu5gQBoi2svi', NOW()),
              (2, 2, 'medic', '$2a$10$7DO2tMe6QSZw7/qpTug3uuoSX7FYhnPMvJ6sSENxvtu5gQBoi2svi', NOW()),
              (3, 3, 'service', '$2a$10$7DO2tMe6QSZw7/qpTug3uuoSX7FYhnPMvJ6sSENxvtu5gQBoi2svi', NOW());

              INSERT INTO user_role (user_id, role_id) VALUES
              (1, 1),
              (2, 2),
              (3, 3);

              INSERT INTO patient (id, person_id, insurance_policy_number) VALUES
              (1, 4, '1234567890'),
              (2, 5, '0987654321');

              INSERT INTO device (id, device_sn, location, status) VALUES
              (1, 'SN-001', 'Room 101', 'Работает'),
              (2, 'SN-002', 'Room 202', 'В обслуживании');

              INSERT INTO study (id, patient_id, user_id, device_id, status, dicom_id, notes) VALUES
              (1, 1, 2, 1, 'Planned', 'DICOM-001', 'Initial planned study'),
              (2, 2, 2, 2, 'Planned', 'DICOM-002', 'Follow-up planned study');

              INSERT INTO device_comment (id, device_id, user_id, comment_text, created_at) VALUES
              (1, 1, 3, 'Device inspected, no issues found', NOW() - INTERVAL '1 day'),
              (2, 2, 3, 'Awaiting maintenance completion', NOW());

              INSERT INTO schedule (id, start_time, end_time, study_id, scheduled_by_user_id, comments) VALUES
              (1, NOW() + INTERVAL '1 hour', NOW() + INTERVAL '2 hours', 1, 2, 'Scheduled by medic'),
              (2, NOW() + INTERVAL '3 hours', NOW() + INTERVAL '4 hours', 2, 2, 'Second appointment');

              INSERT INTO audit_log (id, user_id, action_type, entity, entity_id, created_at, details) VALUES
              (1, 1, 'Создание', 'user_profile', 1, NOW() - INTERVAL '2 days', 'Initial admin creation'),
              (2, 1, 'Создание', 'user_profile', 2, NOW() - INTERVAL '2 days', 'Medic account created'),
              (3, 1, 'Создание', 'user_profile', 3, NOW() - INTERVAL '2 days', 'Service account created'),
              (4, 2, 'Изменение', 'study', 1, NOW() - INTERVAL '1 day', 'Updated study details'),
              (5, 2, 'Изменение', 'study', 2, NOW(), 'Updated study details');
      rollback: |
        DELETE FROM audit_log WHERE id IN (1, 2, 3, 4, 5);
        DELETE FROM schedule WHERE id IN (1, 2);
        DELETE FROM device_comment WHERE id IN (1, 2);
        DELETE FROM study WHERE id IN (1, 2);
        DELETE FROM device WHERE id IN (1, 2);
        DELETE FROM patient WHERE id IN (1, 2);
        DELETE FROM user_role WHERE (user_id, role_id) IN ((1,1),(2,2),(3,3));
        DELETE FROM user_profile WHERE id IN (1, 2, 3);
        DELETE FROM role WHERE id IN (1, 2, 3);
        DELETE FROM person WHERE id IN (1, 2, 3, 4, 5);
